
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://clarchnotes.github.io/RISCV/ISA/softfloat/">
      
      
        <link rel="prev" href="../../">
      
      
        <link rel="next" href="../Zfh_Zfhmin/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>SPIKE SoftFloat库分析 - Arch Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="lime" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spike-softfloat" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="Arch Notes" class="md-header__button md-logo" aria-label="Arch Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Arch Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SPIKE SoftFloat库分析
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../CPU/" class="md-tabs__link">
          
  
  
    
  
  CPU

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  RISCV

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../RVV/" class="md-tabs__link">
          
  
  
    
  
  RVV

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Arch Notes" class="md-nav__button md-logo" aria-label="Arch Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Arch Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../CPU/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    CPU
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            CPU
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Frontend
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Frontend
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Decoder
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            Decoder
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/fontend/decoder/ht_write_decoder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to write efficient decoder
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Backend
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Backend
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_3_1" id="__nav_2_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LSU
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_1">
            <span class="md-nav__icon md-icon"></span>
            LSU
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LSU Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../CPU/Backend/LSU/xiangshan/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Xiangshan
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3_1_2" id="__nav_2_3_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Xiangshan
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/xiangshan/lsu_microarch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LSU Microarchitecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3_1_2_3" id="__nav_2_3_1_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LSQ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_3_1_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_1_2_3">
            <span class="md-nav__icon md-icon"></span>
            LSQ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/xiangshan/lsq/freelist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FreeList
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/xiangshan/lsq/virtual_load_queue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VirtualLoadQueue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/xiangshan/lsq/load_queue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LoadQueue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/xiangshan/lsq/load_queue_raw/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LoadQueueRAW
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/xiangshan/lsq/load_queue_rar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LoadQueueRAR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/xiangshan/lsq/load_queue_replay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LoadQueueReplay 模块文档
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/xiangshan/lsq/load_queue_uncache/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LoadQueueUncache 模块文档
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/xiangshan/lsq/load_queue_exception/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Load 异常缓冲 LqExceptionBuffer 模块
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/xiangshan/lsq/load_misalign_buffer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LoadMisalignBuffer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/xiangshan/lsq/store_queue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    StoreQueue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/xiangshan/lsq/store_queue_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    StoreQueueData
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3_1_3" id="__nav_2_3_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    MDP
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            MDP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CPU/Backend/LSU/MDP/papers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory Dependence Prediction
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    RISCV
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            RISCV
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ISA
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            ISA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    SPIKE SoftFloat库分析
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    SPIKE SoftFloat库分析
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      整体代码结构
    </span>
  </a>
  
    <nav class="md-nav" aria-label="整体代码结构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-softfloat_typesh" class="md-nav__link">
    <span class="md-ellipsis">
      1. 类型定义与表示 (softfloat_types.h)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 状态管理与控制
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specializeh" class="md-nav__link">
    <span class="md-ellipsis">
      specialize.h详细分析
    </span>
  </a>
  
    <nav class="md-nav" aria-label="specialize.h详细分析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-nan" class="md-nav__link">
    <span class="md-ellipsis">
      1. 默认NaN值定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nan" class="md-nav__link">
    <span class="md-ellipsis">
      2. NaN检测和处理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-nan" class="md-nav__link">
    <span class="md-ellipsis">
      3. NaN传播机制
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4. 类型转换溢出值
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      浮点类型转换实现
    </span>
  </a>
  
    <nav class="md-nav" aria-label="浮点类型转换实现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-f32_to_i32" class="md-nav__link">
    <span class="md-ellipsis">
      1. 浮点到整数的转换 (f32_to_i32)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-i32_to_f32" class="md-nav__link">
    <span class="md-ellipsis">
      2. 整数到浮点的转换 (i32_to_f32)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      基本运算的详细实现
    </span>
  </a>
  
    <nav class="md-nav" aria-label="基本运算的详细实现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-f32_mul" class="md-nav__link">
    <span class="md-ellipsis">
      1. 乘法实现 (f32_mul)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-f32_div" class="md-nav__link">
    <span class="md-ellipsis">
      2. 除法实现 (f32_div)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      详细示例
    </span>
  </a>
  
    <nav class="md-nav" aria-label="详细示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-32-375-20" class="md-nav__link">
    <span class="md-ellipsis">
      示例1: 32位浮点数乘法 (3.75 × 2.0)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-3216-f32_to_f16-15" class="md-nav__link">
    <span class="md-ellipsis">
      示例2: 32位浮点数到16位的转换 (f32_to_f16, 值为1.5)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-nan-nan-10" class="md-nav__link">
    <span class="md-ellipsis">
      示例3: 处理特殊值 - NaN的传播 (NaN + 1.0)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      总结与比较
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Zfh_Zfhmin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RISC-V浮点扩展(Zfh/Zfhmin/Zfbfmin/Zvfbfmin/Zvfbfwma)研究报告
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../RVV/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    RVV
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            RVV
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../RVV/ISA/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    ISA
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            ISA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../RVV/ISA/reduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RISC-V 向量归约指令概述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../RVV/ISA/permutation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RISC-V 向量置换与移动指令概述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../RVV/ISA/int_arith/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RISC-V 向量算术与逻辑运算指令概述
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      整体代码结构
    </span>
  </a>
  
    <nav class="md-nav" aria-label="整体代码结构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-softfloat_typesh" class="md-nav__link">
    <span class="md-ellipsis">
      1. 类型定义与表示 (softfloat_types.h)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 状态管理与控制
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specializeh" class="md-nav__link">
    <span class="md-ellipsis">
      specialize.h详细分析
    </span>
  </a>
  
    <nav class="md-nav" aria-label="specialize.h详细分析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-nan" class="md-nav__link">
    <span class="md-ellipsis">
      1. 默认NaN值定义
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nan" class="md-nav__link">
    <span class="md-ellipsis">
      2. NaN检测和处理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-nan" class="md-nav__link">
    <span class="md-ellipsis">
      3. NaN传播机制
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4. 类型转换溢出值
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      浮点类型转换实现
    </span>
  </a>
  
    <nav class="md-nav" aria-label="浮点类型转换实现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-f32_to_i32" class="md-nav__link">
    <span class="md-ellipsis">
      1. 浮点到整数的转换 (f32_to_i32)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-i32_to_f32" class="md-nav__link">
    <span class="md-ellipsis">
      2. 整数到浮点的转换 (i32_to_f32)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      基本运算的详细实现
    </span>
  </a>
  
    <nav class="md-nav" aria-label="基本运算的详细实现">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-f32_mul" class="md-nav__link">
    <span class="md-ellipsis">
      1. 乘法实现 (f32_mul)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-f32_div" class="md-nav__link">
    <span class="md-ellipsis">
      2. 除法实现 (f32_div)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      详细示例
    </span>
  </a>
  
    <nav class="md-nav" aria-label="详细示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-32-375-20" class="md-nav__link">
    <span class="md-ellipsis">
      示例1: 32位浮点数乘法 (3.75 × 2.0)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-3216-f32_to_f16-15" class="md-nav__link">
    <span class="md-ellipsis">
      示例2: 32位浮点数到16位的转换 (f32_to_f16, 值为1.5)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-nan-nan-10" class="md-nav__link">
    <span class="md-ellipsis">
      示例3: 处理特殊值 - NaN的传播 (NaN + 1.0)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      总结与比较
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="spike-softfloat">SPIKE SoftFloat库分析<a class="headerlink" href="#spike-softfloat" title="Permanent link">&para;</a></h1>
<p>SoftFloat是一个纯软件实现的IEEE 754浮点运算库，RISC-V的SPIKE模拟器使用它来实现各种浮点指令。</p>
<h2 id="_1">整体代码结构<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>SoftFloat库的代码结构组织清晰，主要包含以下部分：</p>
<ol>
<li><strong>基础类型定义</strong> (<code>softfloat_types.h</code>)</li>
<li>定义了各种精度的浮点数类型：<code>float16_t</code>、<code>bfloat16_t</code>(16位)、<code>float32_t</code>(32位)、<code>float64_t</code>(64位)、<code>float128_t</code>(128位)和<code>extFloat80_t</code>(80位扩展精度)</li>
<li>
<p>这些类型使用位字段表示而非直接使用C原生浮点类型</p>
</li>
<li>
<p><strong>主要API接口</strong> (<code>softfloat.h</code>)</p>
</li>
<li>定义了舍入模式：<code>softfloat_round_near_even</code>、<code>softfloat_round_min</code>等</li>
<li>定义了异常标志：<code>softfloat_flag_inexact</code>、<code>softfloat_flag_underflow</code>等</li>
<li>
<p>声明了大量浮点运算函数：加减乘除、比较、转换、舍入等</p>
</li>
<li>
<p><strong>特殊值处理</strong> (<code>specialize.h</code>)</p>
</li>
<li>定义了NaN(非数字)的处理逻辑</li>
<li>包含识别和处理信号NaN(signaling NaN)的函数</li>
<li>
<p>提供特殊值(如∞、NaN)的默认位模式</p>
</li>
<li>
<p><strong>内部实现细节</strong> (<code>internals.h</code>)</p>
</li>
<li>提供位操作宏来访问浮点数的符号、指数和尾数</li>
<li>定义归一化、舍入和打包函数</li>
<li>
<p>包含运算核心算法实现</p>
</li>
<li>
<p><strong>具体算法实现文件</strong></p>
</li>
<li>如<code>f32_add.c</code>、<code>s_roundPackToF32.c</code>等，用于实现各种具体操作</li>
</ol>
<h3 id="1-softfloat_typesh">1. 类型定义与表示 (<code>softfloat_types.h</code>)<a class="headerlink" href="#1-softfloat_typesh" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">v</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">float16_t</span><span class="p">;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">typedef</span><span class="w"> </span><span class="n">float16_t</span><span class="w"> </span><span class="n">bfloat16_t</span><span class="p">;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">v</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">float32_t</span><span class="p">;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">v</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">float64_t</span><span class="p">;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">float128_t</span><span class="p">;</span>
</span></code></pre></div>
<p>每种类型都是将IEEE 754位模式封装在简单结构中，而非使用C原生浮点类型，这确保了跨平台的行为一致性。</p>
<h3 id="2">2. 状态管理与控制<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">extern</span><span class="w"> </span><span class="n">THREAD_LOCAL</span><span class="w"> </span><span class="kt">uint_fast8_t</span><span class="w"> </span><span class="n">softfloat_detectTininess</span><span class="p">;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="k">extern</span><span class="w"> </span><span class="n">THREAD_LOCAL</span><span class="w"> </span><span class="kt">uint_fast8_t</span><span class="w"> </span><span class="n">softfloat_roundingMode</span><span class="p">;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="k">extern</span><span class="w"> </span><span class="n">THREAD_LOCAL</span><span class="w"> </span><span class="kt">uint_fast8_t</span><span class="w"> </span><span class="n">softfloat_exceptionFlags</span><span class="p">;</span>
</span></code></pre></div>
<p>这些全局变量控制舍入模式、下溢检测时机和异常标志，保证符合IEEE 754规范。</p>
<h2 id="specializeh">specialize.h详细分析<a class="headerlink" href="#specializeh" title="Permanent link">&para;</a></h2>
<p><code>specialize.h</code>文件专门处理特殊浮点值（如NaN、无穷大）和特殊情况，其核心功能有：</p>
<h3 id="1-nan">1. 默认NaN值定义<a class="headerlink" href="#1-nan" title="Permanent link">&para;</a></h3>
<p><div class="language-c highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="cp">#define defaultNaNF16UI 0x7E00</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="cp">#define defaultNaNF32UI 0x7FC00000</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="cp">#define defaultNaNF64UI UINT64_C(0x7FF8000000000000)</span>
</span></code></pre></div>
定义了各种精度下默认NaN的位模式。</p>
<h3 id="2-nan">2. NaN检测和处理<a class="headerlink" href="#2-nan" title="Permanent link">&para;</a></h3>
<p><div class="language-c highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="cp">#define softfloat_isSigNaNF32UI(uiA) \</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="cp">  ((((uiA) &amp; 0x7FC00000) == 0x7F800000) &amp;&amp; ((uiA) &amp; 0x003FFFFF))</span>
</span></code></pre></div>
定义了识别信号NaN(signaling NaN)的宏，信号NaN会在使用时触发无效操作异常。</p>
<h3 id="3-nan">3. NaN传播机制<a class="headerlink" href="#3-nan" title="Permanent link">&para;</a></h3>
<p><div class="language-c highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="nf">softfloat_propagateNaNF32UI</span><span class="p">(</span><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="n">uiA</span><span class="p">,</span><span class="w"> </span><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="n">uiB</span><span class="p">);</span>
</span></code></pre></div>
当操作数包含NaN时，决定结果中应返回哪个NaN。这遵循IEEE规则，优先返回信号NaN（在设置无效操作标志后转换为静默NaN）。</p>
<h3 id="4">4. 类型转换溢出值<a class="headerlink" href="#4" title="Permanent link">&para;</a></h3>
<p><div class="language-c highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="cp">#define ui32_fromPosOverflow 0xFFFFFFFF</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="cp">#define ui32_fromNegOverflow 0</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="cp">#define i32_fromPosOverflow  0x7FFFFFFF</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="cp">#define i32_fromNegOverflow  (-0x7FFFFFFF - 1)</span>
</span></code></pre></div>
定义了浮点数转整数时溢出情况下应返回的值。</p>
<h2 id="_2">浮点类型转换实现<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="1-f32_to_i32">1. 浮点到整数的转换 (f32_to_i32)<a class="headerlink" href="#1-f32_to_i32" title="Permanent link">&para;</a></h3>
<p>以<code>f32_to_i32</code>为例，转换过程如下：</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kt">int_fast32_t</span><span class="w"> </span><span class="nf">f32_to_i32</span><span class="p">(</span><span class="n">float32_t</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">uint_fast8_t</span><span class="w"> </span><span class="n">roundingMode</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">exact</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="n">uiA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">v</span><span class="p">;</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="kt">int16_t</span><span class="w"> </span><span class="n">exp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expF32UI</span><span class="p">(</span><span class="n">uiA</span><span class="p">);</span><span class="w">  </span><span class="c1">// 提取指数</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="n">sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fracF32UI</span><span class="p">(</span><span class="n">uiA</span><span class="p">);</span><span class="w">  </span><span class="c1">// 提取尾数</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">signF32UI</span><span class="p">(</span><span class="n">uiA</span><span class="p">);</span><span class="w">  </span><span class="c1">// 提取符号位</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">    </span><span class="c1">// 特殊情况检查（零、NaN、无穷大）</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">exp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sig</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">i32_fromNaN</span><span class="p">;</span><span class="w">  </span><span class="c1">// NaN</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">i32_fromNegOverflow</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">i32_fromPosOverflow</span><span class="p">;</span><span class="w">  </span><span class="c1">// 无穷大</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">    </span><span class="c1">// 调整尾数（加上隐含的前导1）</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">exp</span><span class="p">)</span><span class="w"> </span><span class="n">sig</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mh">0x00800000</span><span class="p">;</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">    </span><span class="c1">// 计算需要移位的位数</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">shiftCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x9E</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">exp</span><span class="p">;</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">    </span><span class="c1">// 对尾数进行移位，准备舍入</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">shiftCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w">        </span><span class="n">sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">softfloat_shiftRightJam32</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span><span class="w"> </span><span class="n">shiftCount</span><span class="p">);</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="w">        </span><span class="n">sig</span><span class="w"> </span><span class="o">&lt;&lt;=</span><span class="w"> </span><span class="o">-</span><span class="n">shiftCount</span><span class="p">;</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="w">    </span><span class="c1">// 根据舍入模式进行舍入，返回结果</span>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">softfloat_roundToI32</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span><span class="w"> </span><span class="n">sig</span><span class="p">,</span><span class="w"> </span><span class="n">roundingMode</span><span class="p">,</span><span class="w"> </span><span class="n">exact</span><span class="p">);</span>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="2-i32_to_f32">2. 整数到浮点的转换 (i32_to_f32)<a class="headerlink" href="#2-i32_to_f32" title="Permanent link">&para;</a></h3>
<p>对于<code>i32_to_f32</code>，主要步骤包括：</p>
<ol>
<li>处理零和特殊情况</li>
<li>确定符号</li>
<li>提取绝对值并归一化（找到最高有效位）</li>
<li>计算指数</li>
<li>舍入并打包结果</li>
</ol>
<div class="language-c highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">float32_t</span><span class="w"> </span><span class="nf">i32_to_f32</span><span class="p">(</span><span class="kt">int32_t</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">sign</span><span class="p">;</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="n">absA</span><span class="p">;</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">shiftCount</span><span class="p">;</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">packToF32UI</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">  </span><span class="c1">// 零</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">    </span><span class="n">sign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">    </span><span class="n">absA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w">  </span><span class="c1">// 取绝对值</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">    </span><span class="c1">// 归一化 - 找到最高有效位</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">    </span><span class="n">shiftCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">softfloat_countLeadingZeros32</span><span class="p">(</span><span class="n">absA</span><span class="p">);</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">    </span><span class="c1">// 计算指数和调整尾数</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">exp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x9E</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">shiftCount</span><span class="p">;</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">    </span><span class="n">absA</span><span class="w"> </span><span class="o">&lt;&lt;=</span><span class="w"> </span><span class="n">shiftCount</span><span class="p">;</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="w">    </span><span class="c1">// 提取尾数（去掉隐含的前导1）</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="w">    </span><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="n">sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absA</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x7FFFFFFF</span><span class="p">;</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="w">    </span><span class="c1">// 打包并舍入</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">softfloat_roundPackToF32</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span><span class="w"> </span><span class="n">exp</span><span class="p">,</span><span class="w"> </span><span class="n">sig</span><span class="p">);</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="p">}</span>
</span></code></pre></div>
<h2 id="_3">基本运算的详细实现<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="1-f32_mul">1. 乘法实现 (f32_mul)<a class="headerlink" href="#1-f32_mul" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">float32_t</span><span class="w"> </span><span class="nf">f32_mul</span><span class="p">(</span><span class="n">float32_t</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">float32_t</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">    </span><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="n">uiA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">v</span><span class="p">;</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">    </span><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="n">uiB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">v</span><span class="p">;</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">signA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">signF32UI</span><span class="p">(</span><span class="n">uiA</span><span class="p">);</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">signB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">signF32UI</span><span class="p">(</span><span class="n">uiB</span><span class="p">);</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">signResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">signA</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">signB</span><span class="p">;</span><span class="w">  </span><span class="c1">// 异或确定结果符号</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">    </span><span class="kt">int16_t</span><span class="w"> </span><span class="n">expA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expF32UI</span><span class="p">(</span><span class="n">uiA</span><span class="p">);</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">    </span><span class="kt">int16_t</span><span class="w"> </span><span class="n">expB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expF32UI</span><span class="p">(</span><span class="n">uiB</span><span class="p">);</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">    </span><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="n">sigA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fracF32UI</span><span class="p">(</span><span class="n">uiA</span><span class="p">);</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">    </span><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="n">sigB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fracF32UI</span><span class="p">(</span><span class="n">uiB</span><span class="p">);</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">    </span><span class="c1">// 特殊值处理（零、NaN、无穷大）</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">expA</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sigA</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">((</span><span class="n">expB</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">sigB</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">softfloat_propagateNaNF32UI</span><span class="p">(</span><span class="n">uiA</span><span class="p">,</span><span class="w"> </span><span class="n">uiB</span><span class="p">);</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">expB</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">sigB</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">            </span><span class="n">softfloat_raiseFlags</span><span class="p">(</span><span class="n">softfloat_flag_invalid</span><span class="p">);</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">packToF32UI</span><span class="p">(</span><span class="n">signResult</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x400000</span><span class="p">);</span><span class="w">  </span><span class="c1">// 无穷大 × 零 = NaN</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">packToF32UI</span><span class="p">(</span><span class="n">signResult</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">  </span><span class="c1">// 无穷大 × 有限值 = 无穷大</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">expB</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="w">        </span><span class="c1">// 类似处理...</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="w">    </span><span class="c1">// 处理零和非规格化数</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">expA</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">sigA</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">packToF32UI</span><span class="p">(</span><span class="n">signResult</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">  </span><span class="c1">// 零 × 任何值 = 零</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">exp16_sig32</span><span class="w"> </span><span class="n">normExpSig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">softfloat_normSubnormalF32Sig</span><span class="p">(</span><span class="n">sigA</span><span class="p">);</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="w">        </span><span class="n">expA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">normExpSig</span><span class="p">.</span><span class="n">exp</span><span class="p">;</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a><span class="w">        </span><span class="n">sigA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">normExpSig</span><span class="p">.</span><span class="n">sig</span><span class="p">;</span>
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a><span class="w">    </span><span class="c1">// 为B做类似处理...</span>
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a>
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a><span class="w">    </span><span class="c1">// 添加隐含的前导1</span>
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a><span class="w">    </span><span class="n">sigA</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mh">0x00800000</span><span class="p">;</span>
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a><span class="w">    </span><span class="n">sigB</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mh">0x00800000</span><span class="p">;</span>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a>
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a><span class="w">    </span><span class="c1">// 计算结果指数</span>
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a><span class="w">    </span><span class="kt">int16_t</span><span class="w"> </span><span class="n">expResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">expB</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0x7F</span><span class="p">;</span>
</span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a>
</span><span id="__span-8-43"><a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a><span class="w">    </span><span class="c1">// 执行乘法（64位结果）</span>
</span><span id="__span-8-44"><a id="__codelineno-8-44" name="__codelineno-8-44" href="#__codelineno-8-44"></a><span class="w">    </span><span class="kt">uint_fast64_t</span><span class="w"> </span><span class="n">sig64Z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint_fast64_t</span><span class="p">)</span><span class="n">sigA</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sigB</span><span class="p">;</span>
</span><span id="__span-8-45"><a id="__codelineno-8-45" name="__codelineno-8-45" href="#__codelineno-8-45"></a>
</span><span id="__span-8-46"><a id="__codelineno-8-46" name="__codelineno-8-46" href="#__codelineno-8-46"></a><span class="w">    </span><span class="c1">// 提取结果尾数并归一化</span>
</span><span id="__span-8-47"><a id="__codelineno-8-47" name="__codelineno-8-47" href="#__codelineno-8-47"></a><span class="w">    </span><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="n">sigZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sig64Z</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">23</span><span class="p">;</span>
</span><span id="__span-8-48"><a id="__codelineno-8-48" name="__codelineno-8-48" href="#__codelineno-8-48"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sig64Z</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x007FFFFF</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-49"><a id="__codelineno-8-49" name="__codelineno-8-49" href="#__codelineno-8-49"></a><span class="w">        </span><span class="n">sigZ</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="c1">// 粘性位（保留舍入信息）</span>
</span><span id="__span-8-50"><a id="__codelineno-8-50" name="__codelineno-8-50" href="#__codelineno-8-50"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-51"><a id="__codelineno-8-51" name="__codelineno-8-51" href="#__codelineno-8-51"></a>
</span><span id="__span-8-52"><a id="__codelineno-8-52" name="__codelineno-8-52" href="#__codelineno-8-52"></a><span class="w">    </span><span class="c1">// 归一化处理</span>
</span><span id="__span-8-53"><a id="__codelineno-8-53" name="__codelineno-8-53" href="#__codelineno-8-53"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sigZ</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x01000000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-54"><a id="__codelineno-8-54" name="__codelineno-8-54" href="#__codelineno-8-54"></a><span class="w">        </span><span class="n">sigZ</span><span class="w"> </span><span class="o">&gt;&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-8-55"><a id="__codelineno-8-55" name="__codelineno-8-55" href="#__codelineno-8-55"></a><span class="w">        </span><span class="n">expResult</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-8-56"><a id="__codelineno-8-56" name="__codelineno-8-56" href="#__codelineno-8-56"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-57"><a id="__codelineno-8-57" name="__codelineno-8-57" href="#__codelineno-8-57"></a>
</span><span id="__span-8-58"><a id="__codelineno-8-58" name="__codelineno-8-58" href="#__codelineno-8-58"></a><span class="w">    </span><span class="c1">// 检查溢出和下溢</span>
</span><span id="__span-8-59"><a id="__codelineno-8-59" name="__codelineno-8-59" href="#__codelineno-8-59"></a><span class="w">    </span><span class="c1">// 舍入并打包结果</span>
</span><span id="__span-8-60"><a id="__codelineno-8-60" name="__codelineno-8-60" href="#__codelineno-8-60"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">softfloat_roundPackToF32</span><span class="p">(</span><span class="n">signResult</span><span class="p">,</span><span class="w"> </span><span class="n">expResult</span><span class="p">,</span><span class="w"> </span><span class="n">sigZ</span><span class="p">);</span>
</span><span id="__span-8-61"><a id="__codelineno-8-61" name="__codelineno-8-61" href="#__codelineno-8-61"></a><span class="p">}</span>
</span></code></pre></div>
<p>乘法关键步骤：
1. 计算结果符号（异或操作）
2. 计算结果指数（相加后减去偏移）
3. 执行尾数乘法（需要扩展位宽）
4. 归一化结果并处理溢出情况
5. 舍入并打包结果</p>
<h3 id="2-f32_div">2. 除法实现 (f32_div)<a class="headerlink" href="#2-f32_div" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">float32_t</span><span class="w"> </span><span class="nf">f32_div</span><span class="p">(</span><span class="n">float32_t</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">float32_t</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span><span class="c1">// 与乘法类似的前期处理...</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span><span class="c1">// 特殊情况处理</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">expB</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">sigB</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">expA</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">sigA</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">            </span><span class="n">softfloat_raiseFlags</span><span class="p">(</span><span class="n">softfloat_flag_invalid</span><span class="p">);</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">packToF32UI</span><span class="p">(</span><span class="n">signResult</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x400000</span><span class="p">);</span><span class="w">  </span><span class="c1">// 0 ÷ 0 = NaN</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">        </span><span class="n">softfloat_raiseFlags</span><span class="p">(</span><span class="n">softfloat_flag_infinite</span><span class="p">);</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">packToF32UI</span><span class="p">(</span><span class="n">signResult</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">  </span><span class="c1">// 有限值 ÷ 0 = 无穷大</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">    </span><span class="c1">// 生成归一化操作数</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">    </span><span class="c1">// 计算结果指数（相减后加上偏移）</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">    </span><span class="kt">int16_t</span><span class="w"> </span><span class="n">expResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expA</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">expB</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x7F</span><span class="p">;</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">    </span><span class="c1">// 为除法准备操作数</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">    </span><span class="n">sigA</span><span class="w"> </span><span class="o">&lt;&lt;=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="w">    </span><span class="n">sigB</span><span class="w"> </span><span class="o">&lt;&lt;=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">    </span><span class="c1">// 执行除法（返回商和余数）</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">    </span><span class="kt">uint_fast32_t</span><span class="w"> </span><span class="n">sigZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">sigA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">sigB</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sigB</span><span class="p">;</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="w">    </span><span class="c1">// 如果有余数，设置粘性位</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sigA</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">sigB</span><span class="p">)</span><span class="w"> </span><span class="n">sigZ</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="w">    </span><span class="c1">// 归一化并舍入</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">softfloat_roundPackToF32</span><span class="p">(</span><span class="n">signResult</span><span class="p">,</span><span class="w"> </span><span class="n">expResult</span><span class="p">,</span><span class="w"> </span><span class="n">sigZ</span><span class="p">);</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="p">}</span>
</span></code></pre></div>
<p>除法关键步骤：
1. 特殊处理除以零（生成无穷大或NaN）
2. 计算结果指数（相减后加上偏移）
3. 调整尾数表示方式以准备除法
4. 执行尾数除法并处理余数
5. 根据需要归一化结果
6. 舍入并打包最终结果</p>
<h2 id="_4">详细示例<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h3 id="1-32-375-20">示例1: 32位浮点数乘法 (3.75 × 2.0)<a class="headerlink" href="#1-32-375-20" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>解包操作数</strong>:</li>
<li>3.75 = 11.11(二进制) = 0x40E00000: 符号=0, 指数=0x81(129), 尾数=0x600000(1.11)</li>
<li>
<p>2.0 = 10.0(二进制) = 0x40000000: 符号=0, 指数=0x80(128), 尾数=0x000000(1.0)</p>
</li>
<li>
<p><strong>准备操作</strong>:</p>
</li>
<li>结果符号 = 0 ^ 0 = 0 (正)</li>
<li>
<p>添加隐含位后: </p>
<ul>
<li>sigA = 0x00800000 | 0x00600000 = 0x00E00000 (1.11)</li>
<li>sigB = 0x00800000 | 0x00000000 = 0x00800000 (1.0)</li>
</ul>
</li>
<li>
<p><strong>计算指数</strong>:</p>
</li>
<li>
<p>expResult = 129 + 128 - 127 = 130 (0x82)</p>
</li>
<li>
<p><strong>执行乘法</strong>:</p>
</li>
<li>
<p>0x00E00000 × 0x00800000 = 0x70000000000 (十进制: 1.11 × 1.0 = 1.11)</p>
</li>
<li>
<p><strong>归一化与舍入</strong>:</p>
</li>
<li>结果 = 0x70000000000 &gt;&gt; 23 = 0x00E00000</li>
<li>最终结果: 符号=0, 指数=130, 尾数=0x00600000</li>
<li>对应IEEE 754: 0x41700000 (十进制值: 7.5)</li>
</ol>
<h3 id="2-3216-f32_to_f16-15">示例2: 32位浮点数到16位的转换 (f32_to_f16, 值为1.5)<a class="headerlink" href="#2-3216-f32_to_f16-15" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>解包源值</strong>:</li>
<li>
<p>1.5 = 0x3FC00000: 符号=0, 指数=0x7F(127), 尾数=0x400000(1.1)</p>
</li>
<li>
<p><strong>调整指数</strong>:</p>
</li>
<li>F32指数偏移: 127</li>
<li>F16指数偏移: 15</li>
<li>
<p>调整后指数 = 127 - 127 + 15 = 15 (0xF)</p>
</li>
<li>
<p><strong>舍入尾数</strong>:</p>
</li>
<li>F32尾数: 23位</li>
<li>F16尾数: 10位</li>
<li>需要舍去13位</li>
<li>
<p>舍入后尾数 = 0x400000 &gt;&gt; 13 = 0x200 (保留最高10位)</p>
</li>
<li>
<p><strong>检查特殊情况和溢出</strong>:</p>
</li>
<li>
<p>值在F16表示范围内，无需特殊处理</p>
</li>
<li>
<p><strong>打包结果</strong>:</p>
</li>
<li>符号=0, 指数=15, 尾数=0x200</li>
<li>F16结果 = 0x3E00 (十进制值仍为1.5)</li>
</ol>
<h3 id="3-nan-nan-10">示例3: 处理特殊值 - NaN的传播 (NaN + 1.0)<a class="headerlink" href="#3-nan-nan-10" title="Permanent link">&para;</a></h3>
<p>使用函数<code>softfloat_propagateNaNF32UI</code>:</p>
<ol>
<li><strong>识别NaN</strong>:</li>
<li>NaN (0x7FC00000): 符号=0, 指数=0xFF, 尾数=0x400000 (非零，表示NaN)</li>
<li>
<p>1.0 (0x3F800000): 符号=0, 指数=0x7F, 尾数=0x000000</p>
</li>
<li>
<p><strong>检查信号NaN</strong>:</p>
</li>
<li>使用<code>softfloat_isSigNaNF32UI(0x7FC00000)</code> 检查是否为信号NaN</li>
<li>0x7FC00000的尾数最高位为1，表示静默NaN</li>
<li>
<p>如果是信号NaN(如0x7F800001)，会触发无效操作异常</p>
</li>
<li>
<p><strong>返回结果</strong>:</p>
</li>
<li>由于输入是静默NaN，无需触发异常</li>
<li>结果保持为NaN (0x7FC00000)</li>
</ol>
<h2 id="_5">总结与比较<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p>SoftFloat库通过精确实现IEEE 754标准，保证浮点运算在各种平台上的行为一致性，特别适合如RISC-V SPIKE这样的模拟器使用。相比硬件浮点实现：</p>
<ol>
<li>
<p><strong>精确性</strong>：软件实现可完全控制计算过程中的每一步，确保舍入和异常处理与标准完全符合。</p>
</li>
<li>
<p><strong>可移植性</strong>：不依赖硬件浮点单元，可在任何平台上提供一致行为。</p>
</li>
<li>
<p><strong>灵活性</strong>：可轻松修改以支持自定义浮点格式或特殊处理需求。</p>
</li>
<li>
<p><strong>缺点</strong>：性能明显低于硬件实现，但对于模拟器而言，精确性优先于性能。</p>
</li>
</ol>
<p>SoftFloat库是RISC-V SPIKE模拟器的关键组件，帮助确保浮点指令的精确模拟，为RISC-V浮点指令集提供了参考实现。</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../../" class="md-footer__link md-footer__link--prev" aria-label="上一页: Index">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                Index
              </div>
            </div>
          </a>
        
        
          
          <a href="../Zfh_Zfhmin/" class="md-footer__link md-footer__link--next" aria-label="下一页: RISC-V浮点扩展(Zfh/Zfhmin/Zfbfmin/Zvfbfmin/Zvfbfwma)研究报告">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                RISC-V浮点扩展(Zfh/Zfhmin/Zfbfmin/Zvfbfmin/Zvfbfwma)研究报告
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.action.edit", "content.action.view", "content.code.copy", "navigation.footer", "navigation.tabs", "content.code.annotate", "navigation.indexes", "navigation.top", "toc.follow", "search.suggest", "search.highlight", "search.share"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>